<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>用户详情</title>
</head>

<link rel="stylesheet" href="/bootstrap/css/bootstrap.css">
<link href="layui/css/layui.css" rel="stylesheet">
<body>
<!--头部内容-->
<nav class="navbar navbar-expand-lg navbar-light bg-light" data-th-fragment="cuit_userInfo_header">
    <a class="navbar-brand" href="/">CUIT</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="/">首页 <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">收藏</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">购物车</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/userinfo">个人中心</a>
            </li>
            <li class="nav-item dropdown">
                <a data-th-text="${session.username}?:'未登录'" class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                   aria-haspopup="true" aria-expanded="false">
                    未登录
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/login">登录</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="/logout">注销</a>
                </div>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="商品名称..." aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">搜索</button>
        </form>
    </div>
</nav>
<div style="background:#888888;height: 150px">
    <div class="container">
        <div class="row">
            <div class="col-md-12" style="text-align: center">
                <h2 style="padding: 75px;font-size: 48px">个人中心</h2>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-2"></div>
    <div class="col-md-2" data-th-fragment="cuit_menu">
        <ul class="layui-nav layui-nav-tree" lay-filter="test">
            <li class="layui-nav-item layui-nav-itemed">
                <a href="javascript:;">个人中心</a>
                <dl class="layui-nav-child">
                    <dd><a href="/userinfo">个人信息</a></dd>
                    <dd><a href="/address">收货地址</a></dd>
                    <dd><a href="/car">参拍宝贝</a></dd>
                    <dd><a href="/bidhistory">成交历史</a></dd>
                    <dd><a href="/money">个人财产</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item">
                <a href="javascript:;">消息中心</a>
                <dl class="layui-nav-child">
                    <dd><a href="/message">未读消息</a></dd>
                    <dd><a href="/message">历史消息</a></dd>
                </dl>
            </li>
        </ul>
    </div>
    <div class="col-md-6">
        <form class="layui-form" action="" style="padding-top:30px">
            <div class="layui-form-item">
                <label class="layui-form-label">用户名</label>
                <div class="layui-input-block">
                    <input type="text" name="id" style="display: none">
                    <input type="text" name="name" required lay-verify="required" placeholder="请输入标题" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item" style="display: none">
                <label class="layui-form-label">登录名</label>
                <div class="layui-input-block">
                    <input type="text" name="userName" placeholder="请输入标题"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item" style="display: none">
                <label class="layui-form-label">密码</label>
                <div class="layui-input-inline" style="margin-left: 30px">
                    <input type="password" name="password"placeholder="请输入密码" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">邮箱</label>
                <div class="layui-input-block">
                    <input type="text" name="email" required lay-verify="required" placeholder="请输入标题"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">生日</label>
                <div class="layui-input-block">
                    <input type="text" name="date" id="date" lay-verify="date" placeholder="yyyy-MM-dd"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">电话</label>
                <div class="layui-input-block">
                    <input type="text" name="mobile" required lay-verify="required" placeholder="请输入标题"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">爱好</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="like[write]" title="图画">
                    <input type="checkbox" name="like[read]" title="汽车" checked>
                    <input type="checkbox" name="like[dai]" title="玉石">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">性别</label>
                <div class="layui-input-block">
                    <input type="radio" name="sex" value="男" title="男">
                    <input type="radio" name="sex" value="女" title="女" checked>
                </div>
            </div>
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">个人描述</label>
                <div class="layui-input-block">
                    <textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="formDemo">提交修改</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
    </div>
    <div class="col-md-2"></div>
</div>
<script src="jquery/jquery.js"></script>
<script src="bootstrap/js/bootstrap.js"></script>
<script src="layui/layui.js"></script>
<script data-th-inline="javascript">
    layui.use(['layer', 'form', 'element', 'layedit', 'laydate'], function () {
        var element = layui.element, form = layui.form
            , layer = layui.layer
            , layedit = layui.layedit
            , laydate = layui.laydate;
        //日期
        laydate.render({
            elem: '#date'
        });
        laydate.render({
            elem: '#date1'
        });
        //一些事件监听
        element.on('tab(demo)', function (data) {
            console.log(data);
        });
        //监听提交
        form.on('submit(formDemo)', function (data) {
            var params = {
                authority: "user",
                birthday: $("[name='date']").val(),
                description: $("[name='desc']").val(),
                email: $("[name='email']").val(),
                id: $("[name='id']").val(),
                mobile: $("[name='mobile']").val(),
                name: $("[name='name']").val(),
                passWord: $("[name='password']").val(),
                sex: $("input[name='sex']:checked").val(),
                userName: $("[name='userName']").val()
            }
            $.ajax({
                type: "put",
                async: false,
                url: "/cuitUser",
                data: JSON.stringify(params),
                contentType: 'application/json',
                dataType: "json",
                success: function (result, status, xhr) {
                    layer.confirm('更新成功');
                },
                error: function (xhr, status, error) {
                    layer.confirm('更新失败:' + xhr.responseText);
                }
            });
            return false;
        });
        $.ajax({
            type: "get",
            async: false,
            url: "/cuitUser",
            data: {userName: [[${session.username}]]},
            success: function (result, status, xhr) {
                $("[name='id']").val(result.content[0].id);
                $("[name='name']").val(result.content[0].name);
                $("[name='userName']").val(result.content[0].userName);
                $("[name='password']").val(result.content[0].passWord);
                $("[name='mobile']").val(result.content[0].mobile);
                $("[name='email']").val(result.content[0].email);
                $("[name='desc']").val(result.content[0].description);
                $("[name='date']").val(result.content[0].birthday)
                if (result.content[0].sex == '男') {
                    $("[name='sex']:first").attr('checked', 'checked');
                    form.render();
                }
                else {
                    $("[name='sex']:last").attr('checked', 'checked');
                    form.render();
                }
            },
            error: function (xhr, status, error) {
                layer.confirm("获取信息错误");
            }
        });


    });
</script>
</body>
</html>